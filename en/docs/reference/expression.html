<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-reference/expression">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">計算式 | Teigi</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mit0223.github.io/en/docs/reference/expression"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="計算式 | Teigi"><meta data-rh="true" name="description" content="計算式はデータベースの設定の中で動的に値を決定する部分を記述します。"><meta data-rh="true" property="og:description" content="計算式はデータベースの設定の中で動的に値を決定する部分を記述します。"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mit0223.github.io/en/docs/reference/expression"><link data-rh="true" rel="alternate" href="https://mit0223.github.io/en/docs/reference/expression" hreflang="en"><link data-rh="true" rel="alternate" href="https://mit0223.github.io/docs/reference/expression" hreflang="ja"><link data-rh="true" rel="alternate" href="https://mit0223.github.io/docs/reference/expression" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.4a823121.css">
<link rel="preload" href="/en/assets/js/runtime~main.d61f04d9.js" as="script">
<link rel="preload" href="/en/assets/js/main.fb0b146d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="Teigi Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/en/img/logo.svg" alt="Teigi Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Teigi</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/overview">Documentation</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/category/開発者ガイド">開発者ガイド</a><button aria-label="Toggle the collapsible sidebar category &#x27;開発者ガイド&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/category/スキーマ">スキーマ</a><button aria-label="Toggle the collapsible sidebar category &#x27;スキーマ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/category/機能仕様">機能仕様</a><button aria-label="Toggle the collapsible sidebar category &#x27;機能仕様&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/en/docs/category/旧-id-manager-schema--api">旧 ID Manager Schema &amp; API</a><button aria-label="Toggle the collapsible sidebar category &#x27;旧 ID Manager Schema &amp; API&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/classDefinition">クラス定義</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/propertyDefinition">属性定義</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/reference/expression">計算式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/interfaceDefinition">インタフェース定義</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/ACE">アクセス制御エントリ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/JSONDiffPatch">JSONDiffPatchオブジェクト</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/adPasswordSync">Active Directory パスワード同期</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/changePassword">パスワード変更サーブレット</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/classImportSetting">クラスインポート設定</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/classProvProperty">クラスプロビジョニング属性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/classProvSetting">クラスプロビジョニング設定</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/clockDaemon">クロックデーモン</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/connoteObjectInterface">内包オブジェクトに対するインタフェース</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/crypt">AES暗号化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/cryptOrHash">暗号化設定</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/enumDefinition">列挙オブジェクト</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/hash">SHA1 ハッシュ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/importSetting">インポート設定</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/initializePassword">パスワード忘れ受付サーブレット</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/interfaceForPartition">パーティションに対するインタフェース</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/openLdapDbProv">OpenLDAP データベースプロビジョニング</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/openLdapSchemaProv">OpenLDAPスキーマプロビジョニング</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/principalMatching">プリンシパル照合</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/propGroup">属性のグループ化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/propagationSetting">更新伝播設定</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/propertyDerivation">属性値導出</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/propertyMapping">属性名マッピング</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/provPatch">プロビジョニングパッチ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/provRequest">プロビジョニング要求</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/provSetting">プロビジョニング設定</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/provTarget">プロビジョニングターゲット</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/provisioningSettingDependency">プロビジョニング依存設定</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/querymongoDB">問い合わせ式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/stringRestriction">文字列値の補正と正規化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/systemSetting">システム設定オブジェクト</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/task">プロビジョニングタスク</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/taskLog">タスクログオブジェクト</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/taskOperation">プロビジョニング操作命令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/updateBatch">自動更新バッチ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/reference/validationDefinition">バリデーション定義</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/category/旧-id-manager-schema--api"><span itemprop="name">旧 ID Manager Schema &amp; API</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">計算式</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>計算式</h1><p>計算式はデータベースの設定の中で動的に値を決定する部分を記述します。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="計算式が利用できる場所">計算式が利用できる場所<a href="#計算式が利用できる場所" class="hash-link" aria-label="Direct link to 計算式が利用できる場所" title="Direct link to 計算式が利用できる場所">​</a></h2><p>属性定義やインタフェース定義の以下の場所では、計算式を記述することができます。ここでは、その評価方法を説明します。なお、<a href="/en/docs/reference/systemSetting">システム設定</a>で「計算式トレースログを有効にする」を有効にすることで、インタフェースの初期化式・自動更新バッチの自動更新・更新伝播の各処理での式評価結果のトレースログを出力できます。</p><ul><li><a href="/en/docs/reference/propertyDefinition">属性定義</a>の列挙値式</li><li><a href="/en/docs/reference/propertyDerivation">属性値導出</a>の計算式と条件式</li><li><a href="/en/docs/reference/interfaceDefinition">インタフェース定義</a>のフィルタ導出式</li><li><a href="/en/docs/reference/validationDefinition">バリデーション定義</a>のチェック式とメッセージ式</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="組み込み関数">組み込み関数<a href="#組み込み関数" class="hash-link" aria-label="Direct link to 組み込み関数" title="Direct link to 組み込み関数">​</a></h2><p>計算式は JavaScript の式であり、以下の関数を使用することができます。</p><table><thead><tr><th>関数名</th><th>説明</th><th>サーバ</th><th>ガジェット</th></tr></thead><tbody><tr><td>this<!-- -->(<!-- -->)</td><td>編集対象となっているオブジェクトを取得する。 本関数の結果オブジェクトが保持する属性の値は、正規化・補正された値が設定される。 また、編集対象オブジェクトに設定されている属性のほか、属性定義で「導出式設定が設定されており、かつ、自オブジェクトの更新伝播の伝播先に指定されている」または 「自オブジェクトの更新伝播の伝播元または依存属性に指定されている」属性についても、式評価結果を参照できる。ただし、インタフェース定義でアクセス対象外に指定されている属性は参照できない。</td><td>○</td><td>○</td></tr><tr><td>parent<!-- -->(<!-- -->)</td><td>編集対象となっているオブジェクトが別のオブジェクトに内包されている場合に、内包している親オブジェクトを取得する</td><td>○</td><td>○</td></tr><tr><td>grandparent<!-- -->(<!-- -->)</td><td>編集対象となっているオブジェクトが別のオブジェクトに 2 段階で内包されている場合に、内包している祖父オブジェクトを取得する</td><td>○</td><td>○</td></tr><tr><td>user<!-- -->(<!-- -->)</td><td>アクセスしているユーザのユーザID を取得する</td><td>○</td><td>○</td></tr><tr><td>groups<!-- -->(<!-- -->)</td><td>アクセスしているユーザのグループの文字列配列 を取得する</td><td>○</td><td>○</td></tr><tr><td>roles<!-- -->(<!-- -->)</td><td>アクセスしているユーザのロールオブジェクト を取得する</td><td>○</td><td>○</td></tr><tr><td>getResource<!-- -->(<!-- -->path1<!-- -->[<!-- -->, path2<!-- -->[<!-- -->, path3<!-- -->]<!-- -->]<!-- --> <!-- -->[<!-- -->, filterObj<!-- -->]<!-- -->)</td><td>引数の文字列を結合し、そこで指定されたリソースを取得する。path2が指定された場合、path1（入力値） と path2（入力値のURLエンコード値）を &quot;/&quot; （path1 の末尾が &quot;/&quot; の場合は&quot;&quot; ）　で連結した文字列のリソースを取得する。 path3 が指定された場合、path1, path2の連結文字列と path3 （入力値のURLエンコード値）を&quot;&quot; で連結した文字列のリソースを取得する。 filterObj に<a href="/en/docs/reference/querymongoDB">問い合わせ式</a>のオブジェクトを指定することで、フィルタ条件を設定できる。</td><td>○</td><td>○</td></tr><tr><td>max<!-- -->(<!-- -->a,b<!-- -->)</td><td>a と b の大きいほうを返す</td><td>○</td><td>○</td></tr><tr><td>rand<!-- -->(<!-- -->a,b<!-- -->)</td><td>a から b の範囲の整数の乱数を返す</td><td>○</td><td>○</td></tr><tr><td>uuid<!-- -->(<!-- -->)</td><td>UUID を生成する。</td><td>○</td><td>○</td></tr><tr><td>find<!-- -->(<!-- -->array, key, value<!-- -->)</td><td>オブジェクトの配列 array から key の属性が value である最初のオブジェクトを探して返す。array が null の場合は、空のオブジェクトを返す。</td><td>○</td><td>○</td></tr><tr><td>generatePwd<!-- -->(<!-- -->n<!-- -->)</td><td><a href="/en/docs/reference/systemSetting">システム設定</a>で設定されたパスワードポリシーに従った n 文字のパスワードを生成する。また、生成したパスワードは見分けのつけにくい文字（「0（ゼロ）」、「1（イチ）」、「I（アイ）」、「O（オー）」、「<!-- -->|<!-- -->（パイプ）」、「o（オー）」、「l（エル）」）を含まない。</td><td>○</td><td>○</td></tr><tr><td>generatePwd<!-- -->(<!-- -->n, regex<!-- -->)</td><td>generatePwd<!-- -->(<!-- -->n<!-- -->)<!-- -->と同様のパスワードポリシーに従い、regexで指定された正規表現を満たすパスワードを生成する。</td><td>×</td><td>○</td></tr><tr><td>select<!-- -->(<!-- -->array, property<!-- -->)</td><td>オブジェクトの配列 array から property のプロパティを取得し、配列として返す。array が null の場合や、array 内の各オブジェクトに property のプロパティが存在しない場合には長さ 0 の配列を返す。</td><td>○</td><td>○</td></tr><tr><td>uniq<!-- -->(<!-- -->array<!-- -->)</td><td>配列 array 内の重複を排除した配列を返す。各要素が同じかどうかの判定には、JavaScript 演算子 === を使用する。つまり、array の各要素がオブジェクトの場合には重複排除されない。また、異なるデータ型の場合（例：整数型の1と文字列型の&quot;1&quot;）も、重複排除されない。array が null の場合や、array の長さが 0 の場合には、長さ 0 の配列を返す。</td><td>○</td><td>○</td></tr><tr><td>union<!-- -->(<!-- -->array1<!-- -->[<!-- -->, array2, ..., arrayN<!-- -->]<!-- -->)</td><td>配列 array1 ... arrayN の各要素を含む配列を返す。引数に null が指定された場合、長さ 0 の配列が指定されたものとして処理する。引数で指定された配列すべてに要素が含まれない場合には空の配列を返す。なお、引数に&quot;配列の配列&quot;を指定した場合、ネストした配列は展開されない（例：union<!-- -->(<!-- -->[<!-- -->1,2,3<!-- -->]<!-- -->,<!-- -->[<!-- -->[<!-- -->1,2,3<!-- -->]<!-- -->, <!-- -->[<!-- -->4,5,6<!-- -->]<!-- -->]<!-- --> =<!-- -->&gt;<!-- --> <!-- -->[<!-- -->1,2,3,<!-- -->[<!-- -->1,2,3<!-- -->]<!-- -->, <!-- -->[<!-- -->4,5,6<!-- -->]<!-- -->]<!-- -->）。ネストした配列を展開する場合は flatten<!-- -->(<!-- --> array, false<!-- -->)<!-- --> を使用すること。</td><td>○</td><td>○</td></tr><tr><td>flatten<!-- -->(<!-- -->array, shallow<!-- -->)</td><td>配列 array 内のネストした配列を展開する。shallow が指定された場合、単一階層の展開を行う。（例：flatten<!-- -->(<!-- -->[<!-- -->1, <!-- -->[<!-- -->2<!-- -->]<!-- -->, <!-- -->[<!-- -->3, <!-- -->[<!-- -->[<!-- -->4<!-- -->]<!-- -->]<!-- -->]<!-- -->]<!-- -->)<!-- --> =<!-- -->&gt;<!-- --> <!-- -->[<!-- -->1, 2, 3, 4<!-- -->]<!-- --> 、flatten<!-- -->(<!-- -->[<!-- -->1, <!-- -->[<!-- -->2<!-- -->]<!-- -->, <!-- -->[<!-- -->3, <!-- -->[<!-- -->[<!-- -->4<!-- -->]<!-- -->]<!-- -->]<!-- -->]<!-- -->, true<!-- -->)<!-- --> =<!-- -->&gt;<!-- --> <!-- -->[<!-- -->1, 2, 3, <!-- -->[<!-- -->[<!-- -->4<!-- -->]<!-- -->]<!-- -->]<!-- -->）</td><td>○</td><td>○</td></tr><tr><td>db<!-- -->(<!-- -->)</td><td>当該のオブジェクトが登録されているデータベースを返す。MetaAndRepository インタフェースへのアクセス時など、データベース名が不明な場合には null を返す。</td><td>○</td><td>○</td></tr><tr><td>Date<!-- -->(<!-- -->[<!-- -->expr<!-- -->]<!-- -->)</td><td>Dateオブジェクトを返す。引数が指定された場合、指定された日時のDateオブジェクトを返す。引数には、「1970/1/1 00:00:00からの経過時間（ミリ秒）を表す数値」または「日時を表す文字列」を設定できる。引数が指定されなかった場合、現在日時のDateオブジェクトを返す。日時型プロパティの計算式の結果がDateオブジェクトの場合、&quot;YYYY-mm-ddTHH:MM:ssZ&quot;形式に変換される。日付型プロパティの計算式の結果がDateオブジェクトの場合、ブラウザまたはサーバのタイムゾーン設定の&quot;YYYY-MM-DD&quot;形式に変換される。</td><td>○</td><td>○</td></tr><tr><td>getUnusedIpAddr <!-- -->(<!-- -->fromIp, toIp, usedIps<!-- -->)</td><td>fromIp から toIp の範囲のIPアドレスのうち、usedIps （IPアドレス配列）に含まれないアドレスのもっとも若いものを返す。 範囲内のIPアドレスが全て usedIps に含まれる場合には null を返す。</td><td>○</td><td>○</td></tr><tr><td>getUnusedId <!-- -->(<!-- -->interfaceName, prefix, conflictResolverArray, suffix<!-- -->)</td><td>競合解消文字列配列　conflictResolverArray　に指定された配列から競合解消文字列を１個選び、ID文字列のプレフィックス prefix とサフィックス suffix を前後に結合して候補文字列を生成します。これをキーとして検索インタフェース名 interfaceName で指定されたインタフェースに問い合わせ、競合するオブジェクトが見つからなかった場合は、その候補文字列を返します。競合するオブジェクトが見つかった場合は、次の競合解消文字列を選び、同じ動作を繰り返します。競合解消文字列は配列の先頭から順に試されます。検索インタフェース名で指定されたインタフェースが引数付きインタフェースの場合は、候補文字列は引数として渡され、結果の配列が空の場合に競合がなかったとみなされます。全ての候補文字列で競合するオブジェクトが見つかった場合、エラーを返します。競合解消文字無しの候補値を試行する場合、競合解消文字列配列の先頭に空文字列<!-- -->(<!-- -->&quot;&quot;<!-- -->)<!-- -->を設定します。 （例：ローマ字名の先頭１文字、&quot;-&quot; 、ローマ字姓、競合解消文字列、&quot;@&quot; 、ドメイン名を結合してメールアドレスを生成する場合　「getUnusedId<!-- -->(<!-- -->&quot;mailList&quot;, this<!-- -->(<!-- -->)<!-- -->.roma<!-- -->_<!-- -->gn.substr<!-- -->(<!-- -->0,1<!-- -->)<!-- --> + &quot;-&quot; + this<!-- -->(<!-- -->)<!-- -->.roma<!-- -->_<!-- -->sn, <!-- -->[<!-- -->&quot;&quot;<!-- -->]<!-- -->.concat<!-- -->(<!-- -->select<!-- -->(<!-- -->getResource<!-- -->(<!-- -->&quot;/IDManager/conflictResolverStrings&quot;<!-- -->)<!-- -->, &quot;value&quot;<!-- -->)<!-- -->)<!-- -->,&quot;@&quot; + this<!-- -->(<!-- -->)<!-- -->.domainName<!-- -->)<!-- -->」. ここで、mailList は　mail 属性を引数としたインタフェースであり、 conflictResolverStrings は競合解消文字列のテーブルで 、&quot;&quot; を含む配列と concat で結合することにより、最初は競合解消文字列なしの候補で試行することになります。）</td><td>○</td><td>○</td></tr><tr><td>getUnusedId <!-- -->(<!-- -->interfaceName, prefix, randomNumberSpec, suffix<!-- -->)</td><td>競合解消文字列生成ルール　randomNumberSpec　に指定されたルールに従った乱数を生成し、ID文字列のプレフィックス prefix とサフィックス suffix を前後に結合して候補文字列を生成します。 これをキーとして検索インタフェース名 interfaceName で指定されたインタフェースに問い合わせ、競合するオブジェクトが見つからなかった場合は、その候補文字列を返します。競合するオブジェクトが見つかった場合は、次の乱数を1個生成し、同じ動作を繰り返します。 検索インタフェース名で指定されたインタフェースが引数付きインタフェースの場合は、候補文字列は引数として渡され、結果の配列が空の場合に競合がなかったとみなされます。 乱数生成処理を10,000回試行しても条件に適合する値を導出できない場合、エラーとなります。 競合解消文字列生成ルールは JSON オブジェクトで指定します。以下の属性を指定してください。</td><td></td><td></td></tr></tbody></table><p>|属性名|データ型|意味|
|type|文字列|文字列の生成方法を指定します。&quot;random&quot;を指定してください。|
|numberOfDigits|整数|桁数を指定してください。その桁数で表現可能な整数の中から1個ランダムに数値を選び、桁数に満たない場合は0を左に詰めて文字列を生成します。1以上の数値以外が設定された場合、生成時にエラーとなります。|
|excludeSameNumbers|整数|生成した文字列に、同じ数字がここで指定した桁数以上連続した場合はその番号が除外されます（生成をやり直します）。この属性が指定されていない場合、この除外は行われません。1が指定された場合、生成時にエラーとなります。|
|excludeRegexp|文字列|生成した文字列が、ここで指定した正規表現にマッチする乱数は除外されます（生成をやり直します）。この属性が指定されていない場合、この除外は行われません。正規表現がコンパイルできない場合、生成時にエラーとなります。|</p><p> 例1</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">getUnusedId(&quot;allUserIf&quot;, &quot;&quot;, {type:&quot;random&quot;,numberOfDigits:6, excludeSameNumbers:5, excludeRegexp:&quot;^0&quot;}, Date().getFullYear().toString(10).substr(2,2))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>例2</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">getUnusedId(&quot;allUserIf&quot;, &quot;k&quot;, {type:&quot;random&quot;,numberOfDigits:7, excludeSameNumbers:5}, &quot;&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>|○|○|
|stringify<!-- -->(<!-- -->[<!-- -->expr<!-- -->]<!-- -->)<!-- -->|引数のJSON文字列表現を返す。|○|○|
|getAddressList <!-- -->(<!-- -->fromIp, toIp<!-- -->)<!-- -->|fromIp から toIp の範囲のIPアドレスの配列を返す。引数がIPv4アドレスとして不正な形式の場合や、オクテット毎の数値比較でfromIpがtoIpよりも大きい場合には、空の配列を返す。|○|○|
|romanize <!-- -->(<!-- -->kana<!-- -->)<!-- -->|引数で渡されたカナ文字列をカタカナ補正後、パスポート方式のヘボン式ローマ字に変換して返す。ただし、長音ではない読みの判定はできないため、非長音である可能性のある読みでも長音として変換する。|○|○|
|containsTyoon <!-- -->(<!-- -->kana<!-- -->)<!-- -->|引数で渡されたカナ文字列をカタカナ補正後、romanize 関数が長音として変換するつづりで非長音の可能性があるものが含まれている場合は true を返す。|○|○|</p><p>サーバの列は、REST API を呼び出した時などに BindBroker によって評価される際の使用可否を表します。ガジェットの列は、編集時に列挙値式、導出式やバリデーションを評価する際の使用可否を表します。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="javascript-オブジェクトの関数">JavaScript オブジェクトの関数<a href="#javascript-オブジェクトの関数" class="hash-link" aria-label="Direct link to JavaScript オブジェクトの関数" title="Direct link to JavaScript オブジェクトの関数">​</a></h2><p>計算式では、JavaScript オブジェクトの関数を使用することが出来ます。</p><p>例</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">this().hello_world ? this().hello_world.substring(6) : null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>結果 （計算式を jsfunc<!-- -->_<!-- -->example 属性に指定）</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hello_world&quot;: &quot;Hello World!&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;jsfunc_example&quot;: &quot;World!&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>IDM の属性のデータ型と、JavaScript のオブジェクト型の対応は以下のとおりです。</p><table><thead><tr><th>IDM 属性データ型</th><th>JavaScript のオブジェクトの型</th></tr></thead><tbody><tr><td>文字列</td><td>String</td></tr><tr><td>ブール</td><td>Boolean</td></tr><tr><td>整数</td><td>Number</td></tr><tr><td>浮動小数点数</td><td>Number</td></tr><tr><td>日時</td><td>Date</td></tr><tr><td>日付</td><td>Date</td></tr><tr><td>IPアドレス</td><td>String</td></tr><tr><td>オブジェクト</td><td>Object</td></tr><tr><td>（配列）</td><td>Array</td></tr></tbody></table><p>注意事項を以下に示します。</p><ul><li>サーバ側では ECMAScript5 相当の関数を使用できる。ガジェット側で使用できる関数はブラウザ実装に依存する。</li><li>Array.prototype.shift のように、使用した関数が、呼び出し元のオブジェクトを更新する場合がある点に注意する。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="計算式トレースログの閲覧方法">計算式トレースログの閲覧方法<a href="#計算式トレースログの閲覧方法" class="hash-link" aria-label="Direct link to 計算式トレースログの閲覧方法" title="Direct link to 計算式トレースログの閲覧方法">​</a></h2><p><a href="/en/docs/reference/systemSetting">システム設定</a>で「計算式トレースログを有効にする」を有効にすることで、インタフェースの初期化式・自動更新バッチの自動更新・更新伝播の各処理での式評価結果のトレースログを出力できます。 計算式トレースログの閲覧方法については未執筆です。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/reference/expression.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/reference/propertyDefinition"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">属性定義</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/reference/interfaceDefinition"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">インタフェース定義</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#計算式が利用できる場所" class="table-of-contents__link toc-highlight">計算式が利用できる場所</a></li><li><a href="#組み込み関数" class="table-of-contents__link toc-highlight">組み込み関数</a></li><li><a href="#javascript-オブジェクトの関数" class="table-of-contents__link toc-highlight">JavaScript オブジェクトの関数</a></li><li><a href="#計算式トレースログの閲覧方法" class="table-of-contents__link toc-highlight">計算式トレースログの閲覧方法</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/overview">Documentation</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Procube, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.d61f04d9.js"></script>
<script src="/en/assets/js/main.fb0b146d.js"></script>
</body>
</html>